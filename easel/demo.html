
<html>

<head>
  <script src="https://code.createjs.com/1.0.0/createjs.min.js"></script>
</head>


<body onload="init();">
  <canvas id="demoCanvas" width="1000" height="600"></canvas>
</body>

<script>
/** TODO: extract out to separate file with unit tests (EG: node on CI) */

// From: https://stackoverflow.com/a/966938
function createArray(length) {
    var arr = new Array(length || 0),
        i = length;

    if (arguments.length > 1) {
        var args = Array.prototype.slice.call(arguments, 1);
        while(i--) arr[length-1 - i] = createArray.apply(this, args);
    }

    return arr;
}

function Grid(x y) {
}

  /*
TODO: want to be able to wrap around if at edges of grid

TODO: methods:
rows
cols
ref(x, y)
set(x,y)
each(other-grid, proc)

  */

function Life() {
}

Life.prototype.count = function(grid, x, y) { 
  /*
    (define (life-count grid i j)
      (define (count i j)
        (if (ref grid i j) 1 0))
      (+ (count (- i 1) (- j 1))
         (count (- i 1) j)
         (count (- i 1) (+ j 1))
         (count i (- j 1))
         (count i (+ j 1))
         (count (+ i 1) (- j 1))
         (count (+ i 1) j)
         (count (+ i 1) (+ j 1))))
    )*/
}

Life.prototype.alive = function(grid, x, y) {
  // alive
    /*
    (begin
    (define (life-alive? grid i j)
      (case (life-count grid i j)
            ((3) #t)
            ((2) (ref grid i j))
            (else #f)))
    */
}

Life.prototype.nextgen = function(grid) {
 /*

TODO: no need to limit iterations, just retun the next geneation
      and other code will output that grid to UI

TODO: (not here) GUI may want to be able to pause
    (define (life grid iterations)
      (do ((i 0 (+ i 1))
           (grid0 grid grid1)
           (grid1 (make (rows grid) (cols grid))
                  grid0))
          ((= i iterations))
        (each grid0
          (lambda (j k v)
            (let ((a (life-alive? grid0 j k)))
              (put! grid1 j k a))))
              ;(set! grid1 j k a))))
        (life-print grid1)))))
    */
}

</script>

<script>
  var stage;
  var radius = 50;

  function init() {
    stage = new createjs.Stage("demoCanvas");

    for (var y = radius; y < stage.canvas.height - radius; y+= radius) {
      for (var x = radius; x < stage.canvas.width - radius; x+= radius) {
        var circle = new createjs.Shape();
        circle.graphics.beginFill("#ffffff").drawCircle(0, 0, radius/2-2);
        circle.x = x;
        circle.y = y;
        circle.radius = radius;
        circle.shadow = new createjs.Shadow("#000000", 0, 0, radius/1.5);
        stage.addChild(circle);
      }
    }
    
    stage.update();
    createjs.Ticker.on("tick", tick);

    createjs.Ticker.framerate = 1;
  }

 var active = 0;
  function tick() {
    var c = stage.getChildAt(active);
    //c.graphics.beginFill("#FF0000").drawCircle(0, 0, 25);
    c.graphics.clear().beginFill("#FFffff").drawCircle(0, 0, radius/2-2).endFill();

    active = (active + 1) % stage.children.length;

    c = stage.getChildAt(active);
    c.graphics.clear().beginFill("#FF0000").drawCircle(0, 0, radius/2-2).endFill();
    stage.update();

  }
</script>

</html>
